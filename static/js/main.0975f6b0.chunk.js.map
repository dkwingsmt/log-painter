{"version":3,"sources":["common/App-classes.ts","common/AlertDialog.tsx","common/MultiStep.tsx","step-render/StepRender.tsx","step-render/postprocesses.ts","step-source/parser_chat.ts","step-source/group.ts","step-source/StepSource.tsx","step-config/PaletteSwitch.tsx","step-config/StepConfig.tsx","web/App.tsx","serviceWorker.ts","index.tsx","common/configs.ts","common/colors.ts"],"names":["useStepperStyles","makeStyles","createStyles","Control","display","marginTop","Body","Container","ControlButton","width","marginLeft","AlertDialog","open","onClose","body","Dialog","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","id","DialogActions","Button","onClick","color","autoFocus","MultiStep","props","Step1","step1","Step2","step2","Step3","step3","initConfig","saveConfig","useState","session","setSession","initStates","setInitStates","o1","o2","configStack","setConfigStack","pushConfig","value","popConfig","slice","length","Grid","container","xs","key","show","onNextStep","result","config","args","onPrevStep","onRestart","useStyles","Output","fontFamily","fontSize","padding","borderColor","borderStyle","borderWidth","borderRadius","maxHeight","overflowY","margin","StepRender","useContext","configContext","stepperClasses","classes","playersConfig","useRef","players","lines","generalConfig","resultLines","removeLinesStartedWithParenthesis","filter","line","includes","content","removeLinesStartedWithDot","removeLinesStartedWithLenticular","regularizeQuotes","map","processLines","general","processedLines","snackbarControl","setSnackbarControl","alertOnSnackbar","ClipboardJS","target","element","document","getElementById","Error","on","setImmediate","e","console","error","clipboard","useEffect","destroy","className","item","onDoubleClick","selection","window","getSelection","range","createRange","selectNode","removeAllRanges","addRange","style","float","paragraphId","playerId","player","current","enabled","displayName","contentLine","contentId","concat","justify","variant","backgroundColor","anchorOrigin","vertical","horizontal","autoHideDuration","message","inQuoteChars","outQuoteChars","now","split","ch","join","removeSystemTextConverter","logLine","withdrawParser","withdrawMemberParser","withdrawMember2Parser","commonFriendsParser","joinMemberParser","inviteMemberParser","end","some","toMatch","exec","regNumber","regTitle","regTime","removeMobileDateConverter","dateParser","removeMessageManagerSystemTextConverter","RegExp","source","defaultConverter","trim","splice","trimNumber","src","exportFromLog","headerParser","regDateName","matches","time","name","number","undefined","logLineConverter","copyFromChat","regDateTime","title","flow","copyFromMessageManager","copyFromMobile","getPlayerId","defaultGroupedPlayer","names","Set","add","parseAndGroup","logLines","parsedLine","push","values","groupByPlayers","data","firstLogConfig","parsedHeader","logConfig","currentLogLine","compact","parseChat","StepSource","text","setText","alertControl","setAlertControl","TextField","label","placeholder","multiline","fullWidth","rows","onChange","event","disabled","groupResult","processResult","outerButton","paper","flexDirection","background","menu","flex","descriptionBox","overflowX","descriptionText","descriptionDisplay","height","descriptionDisplayCell","PaletteSwitch","setValue","React","dialogOpen","setDialogOpen","Object","colorPalettes","dialogSelect","setDialogSelect","handleCloseDialog","size","Paper","MenuList","palette","MenuItem","selected","description","contents","PlayerConfig","Center","alignItems","PlayerConfigDashboard","setEnabled","setName","setColor","defaultValue","onBlur","FormGroup","row","FormControl","Switch","checked","visibility","Select","Color","isLight","textAlign","native","paletteColor","StepConfigPlayers","setPlayer","useConfigStyles","marginBottom","StepConfigGeneral","setPalette","FormControlLabel","control","initializePlayers","analysePlayers","playerConfigs","colors","availableColors","existingConfig","sourceNames","reverse","Array","from","playerResult","nameCandidates","uniq","keys","fromPairs","StepConfig","setGeneralConfig","setPlayers","mapValues","useHeaderStyles","logo","marginRight","horizontalFill","toolbarIcon","fill","Header","repoUrl","AppBar","position","Toolbar","Avatar","alt","Typography","IconButton","aria-label","href","rel","svg","GithubIcon","Main","configStorage","sanitizeConfig","load","setConfig","ConfigProvider","Provider","save","theme","createMuiTheme","primary","main","secondary","App","ThemeProvider","maxWidth","realConfigStorage","Boolean","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","then","registration","unregister","defaultGeneralConfig","nonNullValue","emptyConfig","Store","get","set","createContext","initializeColors","rawData","others","rawBbsColors","rawV2Colors","once"],"mappings":"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","file":"static/js/main.0975f6b0.chunk.js","sourcesContent":["import { makeStyles, createStyles } from '@material-ui/core/styles';\n\nexport const useStepperStyles = makeStyles((/*theme: Theme*/) =>\n  createStyles({\n    Control: {\n      display: 'flex',\n      marginTop: 20,\n    },\n    Body: {\n    },\n    Container: {\n    },\n    ControlButton: {\n      width: 100,\n      marginLeft: 10,\n    }\n  }),\n);","import React from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nexport interface AlertDialogControl {\n  open: boolean;\n  body?: React.ReactNode;\n}\n\ninterface AlertDialogProps extends AlertDialogControl {\n  onClose: () => void;\n}\n\nconst AlertDialog: React.FC<AlertDialogProps> = ({ open, onClose, body }: AlertDialogProps) => {\n  return (\n    <div>\n      <Dialog\n        open={open}\n        onClose={onClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle>出错啦</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            {body}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onClose} color=\"primary\" autoFocus>\n            好的\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n};\n\nexport { AlertDialog };","import React, { useState } from 'react';\n\nimport Grid from '@material-ui/core/Grid';\n\ninterface BaseStep {\n  show: boolean;\n}\n\ninterface WithOutArg<OutArg, Config> {\n  onNextStep: (result: OutArg, config: Config) => void;\n}\n\ninterface WithPrevStep<InArg> {\n  args: InArg;\n  onPrevStep: () => void;\n}\n\ninterface WithRestart<Config> {\n  onRestart: (config: Config) => void;\n}\n\nexport type StartStepProps<O, Config> = BaseStep & WithOutArg<O, Config>;\nexport type MiddleStepProps<I, O, Config> = BaseStep & WithOutArg<O, Config> & WithPrevStep<I>;\nexport type EndStepProps<I, Config> = BaseStep & WithPrevStep<I> & WithRestart<Config>;\n\ninterface MultiStepProps<O1, O2, Config> {\n  step1: React.ComponentType<StartStepProps<O1, Config>>;\n  step2: React.ComponentType<MiddleStepProps<O1, O2, Config>>;\n  step3: React.ComponentType<EndStepProps<O2, Config>>;\n  initConfig: () => Config;\n  saveConfig: (value: Config) => void;\n}\n\nconst MultiStep = <O1, O2, Config>(\n  props: MultiStepProps<O1, O2, Config>,\n): React.ReactElement | null => {\n  const { step1: Step1, step2: Step2, step3: Step3, initConfig, saveConfig } = props;\n  // `session` is used to refresh steps (mostly step 1) on restart.\n  const [session, setSession] = useState<number>(0);\n\n  const [initStates, setInitStates] = useState<[O1?, O2?]>([]);\n  const [o1, o2] = initStates;\n\n  const [configStack, setConfigStack] = useState<Config[]>((): Config[] => {\n    return [initConfig()];\n  });\n  function pushConfig(value: Config): void {\n    saveConfig(value);\n    setConfigStack([...configStack, value]);\n  }\n  function popConfig(): void {\n    setConfigStack(configStack.slice(0, configStack.length - 1));\n    saveConfig(configStack[configStack.length - 1]);\n  }\n\n  return (\n    <Grid container xs={12}>\n      <Step1\n        key={`${session}-1`}\n        show={initStates.length === 0}\n        onNextStep={(result: O1, config: Config): void => {\n          pushConfig(config);\n          setInitStates([\n            result,\n          ]);\n        }}\n      />\n\n      {o1 == null ? null : (\n        <Step2\n          key={`${session}-2`}\n          show={initStates.length === 1}\n          args={o1}\n          onPrevStep={(): void => {\n            popConfig();\n            setInitStates([\n            ]);\n          }}\n          onNextStep={(result: O2, config: Config): void => {\n            pushConfig(config);\n            setInitStates([\n              initStates[0],\n              result,\n            ]);\n          }}\n        />\n      )}\n\n      {o2 == null ? null : (\n        <Step3\n          key={`${session}-3`}\n          show={initStates.length === 2}\n          args={o2}\n          onPrevStep={(): void => {\n            popConfig();\n            setInitStates([\n              initStates[0],\n            ]);\n          }}\n          onRestart={(config: Config): void => {\n            setInitStates([]);\n            setSession(session + 1);\n            setConfigStack([config]);\n            saveConfig(config);\n          }}\n        />\n      )}\n    </Grid>\n  );\n};\n\nexport { MultiStep };\n","import React, { useRef, useState, useEffect, useContext } from 'react';\nimport ClipboardJS from 'clipboard';\n\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\n\nimport {\n  useStepperStyles,\n  EndStepProps,\n  Configuration,\n  GeneralConfig,\n  PlayerConfig,\n  configContext,\n} from 'common';\nimport {\n  AnalysedLine,\n} from 'step-source';\nimport {\n  StepConfigResult,\n} from 'step-config';\nimport { regularizeQuotes } from './postprocesses';\n\ntype StepRenderProps = EndStepProps<StepConfigResult, Configuration>;\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    Output: {\n      fontFamily: '微软雅黑',\n      fontSize: 14,\n      padding: '16px 14px',\n\n      borderColor: '#0000003b',\n      '&:hover': {\n        borderColor: '#000000de',\n      },\n      borderStyle: 'solid' ,\n      borderWidth: 1,\n      borderRadius: 4,\n      maxHeight: 200,\n      overflowY: 'scroll',\n\n      '& > p': {\n        margin: '0.5em 0',\n      },\n    },\n  }),\n);\n\n\nconst processLines = (lines: AnalysedLine[], generalConfig: GeneralConfig): AnalysedLine[] => {\n  let resultLines: AnalysedLine[] = lines;\n  if (generalConfig.removeLinesStartedWithParenthesis) {\n    resultLines = resultLines.filter((line: AnalysedLine) => {\n      return !['（', '('].includes(line.content[0][0]);\n    });\n  }\n  if (generalConfig.removeLinesStartedWithDot) {\n    resultLines = resultLines.filter((line: AnalysedLine) => {\n      return !['。', '.'].includes(line.content[0][0]);\n    });\n  }\n  if (generalConfig.removeLinesStartedWithLenticular) {\n    resultLines = resultLines.filter((line: AnalysedLine) => {\n      return !['【'].includes(line.content[0][0]);\n    });\n  }\n  if (generalConfig.regularizeQuotes) {\n    resultLines = resultLines.map((line: AnalysedLine) => ({\n      ...line,\n      content: regularizeQuotes(line.content),\n    }));\n  }\n  return resultLines;\n};\n\ninterface SnackbarControl {\n  body?: React.ReactNode;\n  open: boolean;\n}\n\nexport const StepRender: React.FC<StepRenderProps> = (props: StepRenderProps) => {\n  const { args, onPrevStep, onRestart } = props;\n  const config: Configuration = useContext<Configuration>(configContext);\n  const stepperClasses = useStepperStyles();\n  const classes = useStyles();\n  const playersConfig = useRef<Record<string, PlayerConfig>>(config.players || {});\n  const [processedLines] = useState<AnalysedLine[]>(() => {\n    return processLines(args.lines, config.general || {});\n  });\n  const [snackbarControl, setSnackbarControl] = useState<SnackbarControl>({\n    open: false,\n  });\n  const alertOnSnackbar = (body: React.ReactNode): void => {\n    setSnackbarControl({ body, open: true });\n  };\n  const [clipboard] = useState<ClipboardJS>((): ClipboardJS => {\n    const result: ClipboardJS = new ClipboardJS('#clipboard-button', {\n      target: (): Element => {\n        const element: Element | null = document.getElementById('result-body');\n        if (element == null) {\n          alertOnSnackbar('复制错误：找不到复制对象');\n          throw new Error('找不到复制对象');\n        }\n        return element;\n      },\n    });\n    result.on('success', () => {\n      setImmediate(() => alertOnSnackbar('已复制到剪贴板！'));\n    });\n    result.on('error', (e: ClipboardJS.Event) => {\n      alertOnSnackbar('复制错误！请双击文本框手动复制吧！');\n      console.error(e);\n    });\n    return result;\n  });\n\n  useEffect(() => {\n    return (): void => {\n      clipboard.destroy();\n    };\n  });\n\n  if (!props.show)\n    return null;\n\n  return (\n    <Grid container className={stepperClasses.Container}>\n      <Grid\n        item\n        xs={12}\n        className={stepperClasses.Body}\n      >\n        <div\n          className={classes.Output}\n          onDoubleClick={(): void => {\n            const selection = window.getSelection();\n            if (!selection)\n              return;\n            const element = document.getElementById('result-body');\n            if (!element)\n              return;\n            const range = document.createRange();\n            range.selectNode(element);\n            selection.removeAllRanges();\n            selection.addRange(range);\n          }}\n          id='result-body'\n        >\n          <IconButton\n            style={{\n              float: 'right',\n              marginTop: -15,\n            }}\n            id='clipboard-button'\n          >\n            <FileCopyIcon />\n          </IconButton>\n          {processedLines.map((line: AnalysedLine, paragraphId: number) => {\n            const { playerId, content } = line;\n            const player = playersConfig.current[playerId];\n            if (!player.enabled)\n              return null;\n            return (\n              <p\n                key={paragraphId}\n                style={{\n                  color: player.color,\n                }}\n              >\n                {`<${player.displayName}> `}\n                {content.map((contentLine: string, contentId: number) => {\n                  const newLine = contentId === 0 ? [] : [<br key={`br-${contentId}`}/>];\n                  return newLine.concat([<span key={contentId}>{contentLine}</span>]);\n                })}\n              </p>\n            );\n          })}\n        </div>\n      </Grid>\n      <Grid item xs={12} justify=\"flex-end\" className={stepperClasses.Control}>\n        <Button\n          variant=\"outlined\"\n          color=\"secondary\"\n          className={stepperClasses.ControlButton}\n          onClick={onPrevStep}\n        >\n          上一步\n        </Button>\n        <Button\n          variant=\"contained\"\n          className={stepperClasses.ControlButton}\n          style={{ backgroundColor: '#d4d45f' }}\n          onClick={(): void => { onRestart(config); }}\n        >\n          再做一团\n        </Button>\n      </Grid>\n      <Snackbar\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left',\n        }}\n        open={snackbarControl.open}\n        autoHideDuration={6000}\n        onClose={(): void => {\n          setSnackbarControl({\n            ...snackbarControl,\n            open: false,\n          });\n        }}\n        message={snackbarControl.body}\n      />\n    </Grid>\n  );\n};\n","export function regularizeQuotes(lines: string[]): string[] {\n  const inQuoteChars: string[] = ['\"', '“', '”'];\n  const outQuoteChars: string[] = ['“', '”'];\n  let now = 1;\n\n  function regularizeQuotesLine(line: string): string {\n    return line.split('').map((ch: string) => {\n      if (inQuoteChars.includes(ch)) {\n        now = 1 - now;\n        return outQuoteChars[now];\n      }\n      return ch;\n    }).join('');\n  }\n\n  return lines.map(regularizeQuotesLine);\n}","import compact from 'lodash/compact';\nimport trim from 'lodash/trim';\nimport flow from 'lodash/flow';\n\nexport interface ParsedPlayer {\n  name: string;\n  number?: string;\n  title?: string;\n}\n\nexport interface ParsedLine {\n  time?: string;\n  player: ParsedPlayer;\n  content: string[];\n}\n\nexport interface ParseResult {\n  logLines: ParsedLine[];\n}\n\ninterface ParsedHeader {\n  player: ParsedPlayer;\n  time?: string;\n}\n\ntype HeaderParser = (line: string) => ParsedHeader | null;\ntype LogLineConverter = (logLine: ParsedLine) => ParsedLine | null;\n\ninterface LogConfig {\n  headerParser: HeaderParser;\n  logLineConverter: LogLineConverter;\n}\n\nfunction removeSystemTextConverter(logLine: ParsedLine | null): ParsedLine | null {\n  if (logLine == null)\n    return null;\n  const lines = logLine.content;\n\n  const withdrawParser = /^.*撤回了一条消息( 重新编辑)?$/;\n  const withdrawMemberParser = /^.*撤回了成员.*的一条消息$/;\n  const withdrawMember2Parser = /^.*撤回了一条成员消息$/;\n  const commonFriendsParser = /^你和.*有\\d+个共同好友，点击添加好友。$/;\n  const joinMemberParser = /^.*加入本群。$/;\n  const inviteMemberParser = /^.*邀请.*加入了本群。$/;\n\n  let end = lines.length - 1;\n  for (; end >=0; end--) {\n    if ([\n      /^ *$/,\n      withdrawParser,\n      withdrawMemberParser,\n      withdrawMember2Parser,\n      commonFriendsParser,\n      joinMemberParser,\n      inviteMemberParser,\n    ].some((toMatch: RegExp) => toMatch.exec(lines[end]))) {\n      continue;\n    }\n    break;\n  }\n  logLine.content = logLine.content.slice(0, end + 1);\n  return logLine;\n}\n\nconst regNumber = /\\(\\d+\\)|<.+@.+\\..+>/;\nconst regTitle = /(?:【(.{1,6})】)?/;\nconst regTime = /(?:(?:上午|下午) )?\\d{1,2}:\\d{2}:\\d{2}(?: (?:AM|PM))?/;\n\nfunction removeMobileDateConverter(logLine: ParsedLine | null): ParsedLine | null {\n  if (logLine == null)\n    return null;\n  const lines = logLine.content;\n\n  const dateParser = /^— —  \\d{4}-\\d{1,2}-\\d{1,2}  — —$/;\n\n  let end = lines.length - 1;\n  for (; end >=0; end--) {\n    if ([\n      /^ *$/,\n      dateParser,\n    ].some((toMatch: RegExp) => toMatch.exec(lines[end]))) {\n      continue;\n    }\n    break;\n  }\n  logLine.content = logLine.content.slice(0, end + 1);\n  return logLine;\n}\n\nfunction removeMessageManagerSystemTextConverter(logLine: ParsedLine | null): ParsedLine | null {\n  if (logLine == null)\n    return null;\n  const lines = logLine.content;\n\n  const dateParser = /^ \\d{4}-\\d{2}-\\d{2}$/;\n  const withdrawParser = new RegExp(`^${regTime.source}.*撤回了一条消息$`);\n  const withdrawMemberParser = new RegExp(`^${regTime.source}.*撤回了成员.*的一条消息$`);\n  const withdrawMember2Parser = new RegExp(`^${regTime.source}.*撤回了一条成员消息$`);\n  // const commonFriendsParser = /^你和.*有\\d+个共同好友，点击添加好友。$/;\n  const joinMemberParser = new RegExp(`^${regTime.source}.*加入本群。$`);\n  // const inviteMemberParser = /^.*邀请.*加入了本群。$/;\n\n  let end = lines.length - 1;\n  for (; end >=0; end--) {\n    if ([\n      /^ *$/,\n      dateParser,\n      withdrawParser,\n      withdrawMemberParser,\n      withdrawMember2Parser,\n      joinMemberParser,\n    ].some((toMatch: RegExp) => toMatch.exec(lines[end]))) {\n      continue;\n    }\n    break;\n  }\n  logLine.content = logLine.content.slice(0, end + 1);\n  return logLine;\n}\n\nfunction defaultConverter(logLine: ParsedLine | null): ParsedLine | null {\n  if (logLine == null)\n    return null;\n  const lines = logLine.content;\n  // Remove starting and trailing empty lines.\n  while(lines.length > 0 && lines[0].trim() === '') {\n    lines.splice(0, 1);\n  }\n  while(lines.length > 0 && lines[lines.length-1].trim() === '') {\n    lines.splice(lines.length-1, 1);\n  }\n  if (lines.length === 0)\n    return null;\n  return logLine;\n}\n\nfunction trimNumber(src: string): string {\n  return trim(src, '()<>');\n}\n\n// Export from log\n// E.g. \"2019-09-23 8:43:38 PM 骰娘-Roll100(872001750)\"\n// E.g. \"2019-09-23 8:43:38 PM 骰娘-Roll100\"\nconst exportFromLog: LogConfig = {\n  headerParser: (line: string): ParsedHeader | null => {\n    const regDateName = new RegExp(`\\\\d{4}-\\\\d{2}-\\\\d{2} ${regTime.source}`);\n    const regHeader = new RegExp(`^(${regDateName.source}) (.*?)(${regNumber.source})?$`);\n    const matches = regHeader.exec(line);\n    if (!matches)\n      return null;\n    const [_all, time, name, number] = matches;\n    return {\n      player: {\n        name,\n        number: number == null ? undefined : trimNumber(number),\n      },\n      time,\n    };\n  },\n  logLineConverter: (logLine: ParsedLine): ParsedLine | null => {\n    if (['10000', '1000000'].includes(logLine.player.number || ''))\n      return null;\n    return defaultConverter(logLine);\n  },\n};\n\n// Copy from chat mainwindow or sidewindow\n// E.g. \"【冒泡】无情的围观熊 2/14/2020 9:16:13 PM\"\n// E.g. \"【煤油】丧 丧 熊 9:59:54 PM\"\nconst copyFromChat: LogConfig = {\n  headerParser: (line: string): ParsedHeader | null => {\n    const regDateTime = new RegExp(`(?:\\\\d{1,4}\\\\/\\\\d{1,2}\\\\/\\\\d{1,4} )?${regTime.source}`);\n    const regHeader = new RegExp(`^${regTitle.source}(.*?) (${regDateTime.source})$`);\n    const matches = regHeader.exec(line);\n    if (!matches)\n      return null;\n    const [_all, title, name, time] = matches;\n    return {\n      player: {\n        name,\n        title,\n      },\n      time,\n    };\n  },\n  logLineConverter: (logLine: ParsedLine): ParsedLine | null => {\n    return flow(\n      removeSystemTextConverter,\n      defaultConverter,\n    )(logLine);\n  },\n};\n\n// Copy from message manager\n// E.g. \"织练取(958884) 3:13:28 AM\"\nconst copyFromMessageManager: LogConfig = {\n  headerParser: (line: string): ParsedHeader | null => {\n    const regHeader = new RegExp(`^${regTitle.source}(.*?)(${regNumber.source}) (${regTime.source})$`);\n    const matches = regHeader.exec(line);\n    if (!matches)\n      return null;\n    const [_all, title, name, number, time] = matches;\n    return {\n      player: {\n        name,\n        title,\n        number: trimNumber(number),\n      },\n      time,\n    };\n  },\n  logLineConverter: (logLine: ParsedLine): ParsedLine | null => {\n    return flow(\n      removeMessageManagerSystemTextConverter,\n      defaultConverter,\n    )(logLine);\n  },\n};\n\n// Copy from mobile\n// E.g. \"a dark ideation  23:50:40\"\nconst copyFromMobile: LogConfig = {\n  headerParser: (line: string): ParsedHeader | null => {\n    const regHeader = /^(.*?) {2}(\\d{1,2}:\\d{2}:\\d{2}) *$/;\n    const matches = regHeader.exec(line);\n    if (!matches)\n      return null;\n    const [_all, name, time] = matches;\n    return {\n      player: {\n        name,\n      },\n      time,\n    };\n  },\n  logLineConverter: (logLine: ParsedLine): ParsedLine | null => {\n    return flow(\n      removeMobileDateConverter,\n      defaultConverter,\n    )(logLine);\n  },\n};\n\nexport function parseChat(data: string): ParseResult {\n  const logLines: ParsedLine[] = [];\n  let firstLogConfig: LogConfig | undefined = undefined;\n  for (const line of data.split('\\n')) {\n    const parsedHeader = ((): ParsedHeader | null => {\n      if (firstLogConfig)\n        return firstLogConfig.headerParser(line);\n      for (const logConfig of [\n        copyFromMessageManager,\n        copyFromMobile,\n        exportFromLog,\n        copyFromChat,\n      ]) {\n        const result = logConfig.headerParser(line);\n        if (result) {\n          firstLogConfig = logConfig;\n          return result;\n        }\n      }\n      return null;\n    })();\n    if (parsedHeader) {\n      logLines.push({\n        ...parsedHeader,\n        content: [],\n      });\n    } else {\n      if (firstLogConfig) {\n        const currentLogLine: ParsedLine | undefined = logLines[logLines.length - 1];\n        // Content after a recognizable header\n        if (currentLogLine)\n          currentLogLine.content.push(line);\n      } else {\n        // Unrecognizable content before the first header\n        // Do nothing\n      }\n    }\n  }\n  if (!firstLogConfig)\n    return { logLines: [] };\n\n  const convertedLogLines = compact(\n    logLines.map(firstLogConfig.logLineConverter)\n  );\n  return { logLines: convertedLogLines };\n}\n","import values from 'lodash/values';\n\nimport { parseChat, ParseResult, ParsedPlayer } from './parser_chat';\n\nexport interface AnalysedLine {\n  playerId: string;\n  time?: string;\n  title?: string;\n  content: string[];\n}\n\nexport interface AnalysedPlayer {\n  playerId: string;\n  names: Set<string>;\n}\n\nexport interface GroupResult {\n  players: AnalysedPlayer[];\n  lines: AnalysedLine[];\n};\n\nfunction getPlayerId(player: ParsedPlayer): string {\n  if (player.number)\n    return `qq:${player.number}`;\n  return `name:${player.name}`;\n}\n\nfunction defaultGroupedPlayer(playerId: string, number: string | undefined): AnalysedPlayer {\n  const names = new Set<string>();\n  if (number != null)\n    names.add(number);\n  return {\n    playerId: playerId,\n    names: names,\n  };\n}\n\nfunction groupByPlayers(result: ParseResult): GroupResult {\n  const lines: AnalysedLine[] = [];\n  const players: Record<string, AnalysedPlayer> = {};\n  for (const parsedLine of result.logLines) {\n    const { player, time, content } = parsedLine;\n    const playerId = getPlayerId(player);\n    if (!players.playerId)\n      players[playerId] = defaultGroupedPlayer(playerId, player.number);\n    players[playerId].names.add(player.name);\n    lines.push({\n      playerId: playerId,\n      time,\n      title: player.title,\n      content,\n    });\n  }\n  return {\n    lines,\n    players: values(players),\n  };\n}\n\nexport function parseAndGroup(source: string): GroupResult {\n  const parseResult: ParseResult = parseChat(source);\n  return groupByPlayers(parseResult);\n}\n","import React, { useState, useContext } from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\n\nimport {\n  useStepperStyles,\n  AlertDialog,\n  AlertDialogControl,\n  StartStepProps,\n  Configuration,\n  configContext,\n} from 'common';\nimport { parseAndGroup } from './group';\nimport { analyse, AnalyseResult } from './analyse';\n\nexport type StepSourceResult = AnalyseResult;\n\ntype StepSourceProps = StartStepProps<StepSourceResult, Configuration>;\n\n\nfunction processResult(text: string): AnalyseResult | undefined {\n  const groupResult = parseAndGroup(text);\n  if (groupResult.players.length === 0 || groupResult.lines.length === 0) {\n    return undefined;\n  }\n  return analyse(groupResult);\n}\n\nexport const StepSource: React.FC<StepSourceProps> = (props: StepSourceProps) => {\n  const { onNextStep } = props;\n  const config: Configuration = useContext<Configuration>(configContext);\n  const stepperClasses = useStepperStyles();\n  const [text, setText] = useState<string>('');\n\n  const [alertControl, setAlertControl] = useState<AlertDialogControl>({\n    open: false,\n  });\n\n  if (!props.show)\n    return null;\n\n  return (\n    <Grid container className={stepperClasses.Container}>\n      <Grid item xs={12} className={stepperClasses.Body}>\n        <TextField\n          id=\"outlined-basic\"\n          label=\"原文\"\n          placeholder=\"把原文粘贴到这里，然后点击下一步。\"\n          variant=\"outlined\"\n          multiline\n          fullWidth\n          rows={10}\n          className='Source-textfield'\n          onChange={(event: React.ChangeEvent<HTMLInputElement>): void => {\n            setText(event.target.value);\n          }}\n          value={text}\n        />\n      </Grid>\n      <Grid item xs={12} justify=\"flex-end\" className={stepperClasses.Control}>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          disabled={text.length < 5}\n          className={stepperClasses.ControlButton}\n          onClick={(): void => {\n            const result = processResult(text);\n            if (result == null) {\n              setAlertControl({\n                open: true,\n                body: '无法从这段记录中找到可识别的部分！请检查后再试一次吧！',\n              });\n            } else {\n              onNextStep(result, config);\n            }\n          }}\n        >\n          下一步\n        </Button>\n      </Grid>\n      <AlertDialog\n        onClose={(): void => setAlertControl({\n          ...alertControl,\n          open: false,\n        })}\n        {...alertControl}\n      />\n    </Grid>\n  );\n};","import React, { useState, useRef, useContext } from 'react';\n\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\n\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\n\nimport {\n  ColorPalette,\n  PaletteInfo,\n  colorPalettes,\n} from 'common';\nimport { DescribedColor } from 'common/colors';\n\ninterface PaletteSwitchProps {\n  value: ColorPalette;\n  setValue: (value: ColorPalette) => void;\n  className?: string;\n}\n\nconst useStyles = makeStyles((/*theme: Theme*/) =>\n  createStyles({\n    outerButton: {\n      marginLeft: 10,\n    },\n    paper: {\n      display: 'flex',\n      flexDirection: 'row',\n      background: '#f5f5f5',\n    },\n    menu: {\n      flex: '100pt 0 0',\n    },\n    descriptionBox: {\n      display: 'flex',\n      flexDirection: 'column',\n      fontSize: 'medium',\n      overflowX: 'hidden',\n    },\n    descriptionText: {\n      flex: '80pt 1 0',\n      padding: 20,\n    },\n    descriptionDisplay: {\n      flex: '20pt 0 0',\n      height: 20,\n      display: 'inline-flex',\n      background: 'white',\n    },\n    descriptionDisplayCell: {\n      flex: '1',\n      height: 20,\n    },\n  }),\n);\n\nexport const PaletteSwitch: React.FC<PaletteSwitchProps> = (props: PaletteSwitchProps) => {\n  const { value, setValue, className } = props;\n  const classes = useStyles();\n  const [dialogOpen, setDialogOpen] = React.useState<boolean>(false);\n  const [dialogSelect, setDialogSelect] = React.useState<ColorPalette>(Object.values(colorPalettes)[0].id);\n\n  const current = colorPalettes[value];\n\n  const handleOpenDialog = () => {\n    setDialogOpen(true);\n    setDialogSelect(value);\n  }\n\n  const handleConfirmDialog = () => {\n    setDialogOpen(false);\n    setValue(dialogSelect);\n  }\n\n  const handleCloseDialog = () => {\n    setDialogOpen(false);\n  }\n\n  return (\n    <div className={className}>\n      当前配色方案：{current.name}\n      <Button\n        color=\"secondary\"\n        size=\"small\"\n        variant=\"contained\"\n        onClick={handleOpenDialog}\n        className={classes.outerButton}\n      >\n        切换\n      </Button>\n      <Dialog\n        open={dialogOpen}\n        onClose={handleCloseDialog}\n      >\n        <DialogTitle>更换配色方案</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            你当前的配色方案是“{current.name}”。<br />\n          </DialogContentText>\n          <Paper className={classes.paper}>\n            <MenuList className={classes.menu}>\n              {Object.values(colorPalettes).map((palette: PaletteInfo) => (\n                <MenuItem\n                  key={palette.id}\n                  selected={palette.id == dialogSelect}\n                  onClick={() => { setDialogSelect(palette.id); }}\n                >\n                  {palette.name}\n                </MenuItem>\n              ))}\n            </MenuList>\n            <div className={classes.descriptionBox}>\n              <div className={classes.descriptionText}>\n                {colorPalettes[dialogSelect].description}\n              </div>\n              <div className={classes.descriptionDisplay}>\n                {Object.values(colorPalettes[dialogSelect].contents()).map((color: DescribedColor) => (\n                  <div key={color.value} className={classes.descriptionDisplayCell} style={{ background: color.value }} />\n                ))}\n              </div>\n            </div>\n          </Paper>\n          <DialogContentText>\n            更换配色方案后，所有现有配色设置将重置。\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleConfirmDialog} color=\"primary\" variant=\"contained\" disabled={dialogSelect == value}>\n            确认更换\n          </Button>\n          <Button onClick={handleCloseDialog} color=\"secondary\">\n            不了\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React, { useState, useRef, useContext } from 'react';\nimport Color from 'color';\n\nimport fromPairs from 'lodash/fromPairs';\nimport mapValues from 'lodash/mapValues';\nimport reverse from 'lodash/reverse';\nimport uniq from 'lodash/uniq';\n\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport Switch from '@material-ui/core/Switch';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Select from '@material-ui/core/Select';\nimport FormGroup from '@material-ui/core/FormGroup';\n\nimport {\n  useStepperStyles,\n  MiddleStepProps,\n  configContext,\n  Configuration,\n  PlayerConfig,\n  GeneralConfig,\n  ColorPalette,\n  PaletteInfo,\n  colorPalettes,\n} from 'common';\nimport {\n  AnalysedLine,\n  AnalysedPlayer,\n  StepSourceResult,\n} from 'step-source';\nimport { DescribedColor } from 'common/colors';\nimport { PaletteSwitch } from './PaletteSwitch';\n\nexport interface StepConfigResult {\n  lines: AnalysedLine[];\n}\n\ninterface PlayerConfigProps {\n  name: string;\n  color: string;\n  enabled: boolean;\n  palette: Record<string, DescribedColor>;\n  setName: (value: string) => void;\n  setColor: (value: string) => void;\n  setEnabled: (value: boolean) => void;\n}\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    PlayerConfig: {\n    },\n    Center: {\n      display: 'flex',\n      alignItems: 'center',\n    },\n  }),\n);\n\nconst PlayerConfigDashboard: React.FC<PlayerConfigProps> = (props: PlayerConfigProps) => {\n  const { enabled, setEnabled, name, setName, color, setColor, palette } = props;\n  const classes = useStyles();\n  return (\n    <Grid item xs={6}>\n      <Grid container>\n        <Grid item xs={8}>\n          <TextField\n            defaultValue={props.name}\n            variant=\"outlined\"\n            fullWidth\n            onBlur={(event: React.FocusEvent<HTMLInputElement>): void => {\n              setName(event.target.value || '');\n            }}\n          />\n        </Grid>\n        <Grid item xs={4} className={classes.Center}>\n          <Grid container>\n            <FormGroup row className={classes.Center}>\n              <FormControl>\n                <Switch\n                  checked={enabled}\n                  onChange={(event: React.ChangeEvent<HTMLInputElement>, checked: boolean): void => {\n                    setEnabled(checked);\n                  }}\n                  value=\"primary\"\n                />\n              </FormControl>\n              <FormControl style={enabled ? {} : { visibility: 'hidden' }}>\n                <Select\n                  style={{\n                    backgroundColor: color,\n                    color: Color(color).isLight() ? 'black' : 'white',\n                    padding: '4px 0px',\n                    textAlign: 'center',\n                  }}\n                  native\n                  value={color}\n                  onChange={(event: React.ChangeEvent<{ name?: string; value: unknown }>): void => {\n                    setColor(event.target.value as string);\n                  }}\n                >\n                  {Object.values(palette).map((paletteColor: DescribedColor): React.ReactNode => {\n                    const { value, name, isLight } = paletteColor;\n                    return (\n                      <option\n                        key={value}\n                        value={value}\n                        style={{\n                          backgroundColor: value,\n                          color: isLight ? 'black' : 'white',\n                          textAlign: 'center',\n                        }}\n                      >\n                        {name || value}\n                      </option>\n                    );\n                  })}\n                </Select>\n              </FormControl>\n            </FormGroup>\n          </Grid>\n        </Grid>\n      </Grid>\n    </Grid>\n  );\n};\n\ninterface StepConfigPlayersProps {\n  players: Record<string, ConfigPlayer>;\n  setPlayer: (id: string, value: ConfigPlayer) => void;\n  palette: Record<string, DescribedColor>;\n}\n\nconst StepConfigPlayers: React.FC<StepConfigPlayersProps> = (props: StepConfigPlayersProps) => {\n  const { players, setPlayer, palette } = props;\n  return (\n    <Grid container style={{ overflowY: 'auto' }}>\n      {Object.values(players).map((player: ConfigPlayer) => {\n        return (\n          <PlayerConfigDashboard\n            key={player.id}\n            name={player.name}\n            setName={(value: string): void => {\n              setPlayer(player.id, {\n                ...player,\n                name: value,\n              });\n            }}\n            enabled={player.enabled}\n            setEnabled={(value: boolean): void => {\n              setPlayer(player.id, {\n                ...player,\n                enabled: value,\n              });\n            }}\n            color={player.color}\n            setColor={(value: string): void => {\n              setPlayer(player.id, {\n                ...player,\n                color: value,\n              });\n            }}\n            palette={palette}\n          />\n        );\n      })}\n    </Grid>\n  );\n};\n\n\nconst useConfigStyles = makeStyles((/*theme: Theme*/) =>\n  createStyles({\n    PaletteSwitch: {\n      marginBottom: 10,\n      marginTop: 5,\n    },\n  }),\n);\n\ninterface StepConfigGeneralProps {\n  value: GeneralConfig;\n  setValue: (value: GeneralConfig) => void;\n  setPalette: (value: ColorPalette) => void;\n  className?: string;\n}\n\nconst StepConfigGeneral: React.FC<StepConfigGeneralProps> = (props: StepConfigGeneralProps) => {\n  const { value, setValue, setPalette, className } = props;\n  const classes = useConfigStyles();\n\n  return (\n    <FormGroup className={className}>\n      <FormControlLabel\n        control={\n          <Switch\n            checked={value.removeLinesStartedWithParenthesis}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>): void => {\n              setValue({\n                ...value,\n                removeLinesStartedWithParenthesis: event.target.checked,\n              });\n            }}\n            color=\"primary\"\n          />\n        }\n        label=\"去掉以(（开头的行\"\n      />\n      <FormControlLabel\n        control={\n          <Switch\n            checked={value.removeLinesStartedWithDot}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>): void => {\n              setValue({\n                ...value,\n                removeLinesStartedWithDot: event.target.checked,\n              });\n            }}\n            color=\"primary\"\n          />\n        }\n        label=\"去掉以.。开头的行\"\n      />\n      <FormControlLabel\n        control={\n          <Switch\n            checked={value.removeLinesStartedWithLenticular}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>): void => {\n              setValue({\n                ...value,\n                removeLinesStartedWithLenticular: event.target.checked,\n              });\n            }}\n            color=\"primary\"\n          />\n        }\n        label=\"去掉以【开头的行\"\n      />\n      <FormControlLabel\n        control={\n          <Switch\n            checked={value.regularizeQuotes}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>): void => {\n              setValue({\n                ...value,\n                regularizeQuotes: event.target.checked,\n              });\n            }}\n            color=\"primary\"\n          />\n        }\n        label=\"自动纠正前后引号\"\n      />\n      <PaletteSwitch\n        value={value.palette}\n        setValue={setPalette}\n        className={classes.PaletteSwitch}\n      />\n    </FormGroup>\n  );\n};\n\n\ntype StepConfigProps = MiddleStepProps<StepSourceResult, StepConfigResult, Configuration>;\n\ninterface ConfigPlayer {\n  id: string;\n  name: string;\n  nameCandidates: string[];\n  color: string;\n  enabled: boolean;\n}\n\nfunction initializePlayers(\n  analysePlayers: AnalysedPlayer[],\n  playerConfigs: Record<string, PlayerConfig>,\n  colors: Record<string, DescribedColor>,\n): Record<string, ConfigPlayer> {\n  const availableColors = {...colors};\n  const result = analysePlayers.map((source: AnalysedPlayer) => {\n    const existingConfig = playerConfigs[source.playerId];\n    const sourceNames = reverse(Array.from(source.names));\n    const playerResult: ConfigPlayer = existingConfig != null ? {\n      id: source.playerId,\n      name: existingConfig.displayName,\n      nameCandidates: uniq([existingConfig.displayName, ...sourceNames]),\n      color: existingConfig.color,\n      enabled: existingConfig.enabled,\n    } : {\n      id: source.playerId,\n      name: sourceNames[0],\n      nameCandidates: sourceNames,\n      color: '',\n      enabled: true,\n    };\n    if (!(playerResult.color in colors)) {\n      const color = Object.keys(availableColors)[0];\n      playerResult.color = color;\n    }\n    delete availableColors[playerResult.color];\n    return playerResult;\n  });\n  return fromPairs(result.map((player: ConfigPlayer) => [player.id, player]));\n}\n\nexport const StepConfig: React.FC<StepConfigProps> = (props: StepConfigProps) => {\n  const { args, onPrevStep, onNextStep } = props;\n\n  const config = useContext<Configuration>(configContext);\n  const stepperClasses = useStepperStyles();\n  const [generalConfig, setGeneralConfig] = useState<GeneralConfig>(\n    () => config.general || {},\n  );\n  const palette = colorPalettes[generalConfig.palette];\n  const [players, setPlayers] = useState<Record<string, ConfigPlayer>>(\n    initializePlayers(args.players, config.players, palette.contents()),\n  );\n  const lines = useRef<AnalysedLine[]>(args.lines);\n\n  function setPlayer(id: string, value: ConfigPlayer): void {\n    setPlayers({ ...players, [id]: value });\n  }\n\n  function handleSetPalette(value: ColorPalette): void {\n    setGeneralConfig({ ...generalConfig, palette: value });\n    const palette = colorPalettes[value];\n    setPlayers(initializePlayers(args.players, config.players, palette.contents()));\n  }\n\n  if (!props.show)\n    return null;\n\n  return (\n    <Grid container className={stepperClasses.Container}>\n      <Grid item xs={12} className={stepperClasses.Body}>\n        <StepConfigGeneral\n          value={generalConfig}\n          setValue={setGeneralConfig}\n          setPalette={handleSetPalette}\n        />\n        <StepConfigPlayers\n          players={players}\n          setPlayer={setPlayer}\n          palette={palette.contents()}\n        />\n      </Grid>\n      <Grid item xs={12} justify=\"flex-end\" className={stepperClasses.Control}>\n        <Button\n          variant=\"outlined\"\n          color=\"secondary\"\n          className={stepperClasses.ControlButton}\n          onClick={onPrevStep}\n        >\n          上一步\n        </Button>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          className={stepperClasses.ControlButton}\n          onClick={(): void => {\n            onNextStep(\n              {\n                lines: lines.current,\n              },\n              {\n                players: mapValues(players, (player: ConfigPlayer): PlayerConfig => ({\n                  displayName: player.name,\n                  color: player.color,\n                  enabled: player.enabled,\n                })),\n                general: generalConfig,\n              },\n            );\n          }}\n        >\n          下一步\n        </Button>\n      </Grid>\n    </Grid>\n  );\n};\n","import React, { useState } from 'react';\nimport SVGInline from 'react-svg-inline';\nimport preval from 'preval.macro';\n\nimport GithubIcon from 'simple-icons/icons/github';\n\nimport { makeStyles, createStyles, createMuiTheme } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Avatar from '@material-ui/core/Avatar';\nimport Container from '@material-ui/core/Container';\nimport IconButton from '@material-ui/core/IconButton';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\n\nimport './index.css';\nimport './App.css';\nimport { StepSource, StepSourceResult } from 'step-source';\nimport { StepConfig, StepConfigResult } from 'step-config';\nimport { StepRender } from 'step-render';\nimport {\n  MultiStep,\n  ConfigStorage,\n  configContext,\n  Configuration,\n  realConfigStorage,\n} from 'common';\nimport { sanitizeConfig } from 'common/configs';\n\nconst useHeaderStyles = makeStyles(() =>\n  createStyles({\n    logo: {\n      marginRight: 15,\n      backgroundColor: 'white',\n    },\n    horizontalFill: {\n      flex: '1 0 auto',\n    },\n    toolbarIcon: {\n      height: 24,\n      width: 24,\n      fill: 'white',\n    },\n  }),\n);\n\ninterface HeaderProps {\n  repoUrl: string;\n}\n\nconst Header: React.FC<HeaderProps> = ({ repoUrl }: HeaderProps) => {\n  const classes = useHeaderStyles();\n  return (\n    <AppBar position='static'>\n      <Toolbar>\n        <Avatar alt=\"Logo\" src=\"/android-chrome-512x512.png\" className={classes.logo} />\n        <Typography variant=\"h6\" className={classes.horizontalFill}>\n          DK的跑团记录着色器\n        </Typography>\n        <IconButton\n          aria-label=\"GitHub\"\n          href={repoUrl}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <SVGInline\n            svg={GithubIcon.svg}\n            className={classes.toolbarIcon}\n          />\n        </IconButton>\n      </Toolbar>\n    </AppBar>\n  );\n};\n\ninterface MainProps {\n  configStorage: ConfigStorage;\n}\n\nconst Main: React.FC<MainProps> = (props: MainProps) => {\n  const { configStorage } = props;\n  const [config, setConfig] = useState<Configuration>((): Configuration => {\n    return sanitizeConfig(configStorage.load());\n  });\n  const ConfigProvider = configContext.Provider;\n  const saveConfig = (value: Configuration): void => {\n    setConfig(value);\n    configStorage.save(value);\n  };\n  return (\n    <ConfigProvider value={config}>\n      <MultiStep<StepSourceResult, StepConfigResult, Configuration>\n        step1={StepSource}\n        step2={StepConfig}\n        step3={StepRender}\n        initConfig={(): Configuration => config}\n        saveConfig={saveConfig}\n      />\n    </ConfigProvider>\n  );\n};\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#795548',\n    },\n    secondary: {\n      main: '#00897b',\n    },\n  },\n});\n\nconst App: React.FC = () => {\n  return (\n    <ThemeProvider theme={theme}>\n      <div className=\"root\">\n        <Header\n          repoUrl='https://github.com/dkwingsmt/log-painter'\n        />\n        <Container maxWidth='md' className='Body-container'>\n          <Main\n            configStorage={realConfigStorage}\n          />\n        </Container>\n        <p\n          style={{\n            textAlign: 'center',\n            marginTop: 100,\n            color: '#dddddd',\n            fontSize: 'small',\n          }}\n        >\n            最后更新时间：{preval`module.exports = new Date().toLocaleDateString(\"zh-cn\", {dateStyle: \"full\"})`}\n        </p>\n      </div>\n    </ThemeProvider>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from 'web';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React from 'react';\nimport Store from 'store';\n\nimport { ColorPalette, colorPalettes } from './colors';\n\nexport interface GeneralConfig {\n  removeLinesStartedWithParenthesis: boolean;\n  removeLinesStartedWithDot: boolean;\n  removeLinesStartedWithLenticular: boolean;\n  regularizeQuotes: boolean;\n  palette: ColorPalette;\n}\n\nexport const defaultGeneralConfig: GeneralConfig = {\n  removeLinesStartedWithParenthesis: false,\n  removeLinesStartedWithDot: false,\n  removeLinesStartedWithLenticular: false,\n  regularizeQuotes: false,\n  palette: 'v2',\n};\n\nexport interface PlayerConfig {\n  displayName: string;\n  enabled: boolean;\n  color: string;\n}\n\nexport interface Configuration {\n  players: Record<string, PlayerConfig>;\n  general: GeneralConfig;\n}\n\nexport const sanitizeConfig = (value: {} | undefined): Configuration => {\n  const nonNullValue = (value ?? {}) as Record<string, {}>;\n  const result = {\n    players: (nonNullValue['players'] ?? {}) as Record<string, PlayerConfig>,\n    general: {\n      ...defaultGeneralConfig,\n      ...nonNullValue['general'] as GeneralConfig\n    },\n  };\n  if (!(result.general.palette in colorPalettes)) {\n    result.general.palette = value == null ? 'v2' : 'bbs';\n  }\n  return result;\n};\n\nconst emptyConfig = sanitizeConfig(undefined);\n\nexport interface ConfigStorage {\n  load: () => Configuration | undefined;\n  save: (value: Configuration) => void;\n}\n\nexport const realConfigStorage: ConfigStorage = {\n  load: () => {\n    return Store.get('config');\n  },\n  save: (config: {}): void => {\n    Store.set('config', config);\n  },\n};\n\nexport const configContext: React.Context<Configuration> = React.createContext<Configuration>(emptyConfig);\n","import Color from 'color';\n\nimport fromPairs from 'lodash/fromPairs';\nimport once from 'lodash/once';\n\nexport interface DescribedColor {\n  value: string;\n  name?: string;\n  isLight: boolean;\n}\n\ninterface RawColor {\n  value: string;\n  name: string;\n}\n\nfunction initializeColors(rawData: RawColor[]): Record<string, DescribedColor> {\n  return fromPairs(rawData.map(\n    ({ value, ...others }) => [value, {\n      ...others,\n      value,\n      isLight: Color(value).isLight(),\n    }],\n  ));\n}\n\nconst rawBbsColors = [\n  { value: \"black\", name: \"黑色\" },\n  { value: \"silver\", name: \"灰色\" },\n  { value: \"red\", name: \"红色\" },\n  { value: \"green\", name: \"绿色\" },\n  { value: \"orange\", name: \"橘色\" },\n  { value: \"purple\", name: \"紫色\" },\n  { value: \"teal\", name: \"蓝绿\" },\n  { value: \"fuchsia\", name: \"桃红\" },\n  { value: \"yellow\", name: \"黄色\" },\n  { value: \"beige\", name: \"米色\" },\n  { value: \"brown\", name: \"棕色\" },\n  { value: \"navy\", name: \"深蓝\" },\n  { value: \"maroon\", name: \"紫红\" },\n  { value: \"limegreen\", name: \"莱姆\" },\n  { value: \"white\", name: \"白色\" },\n  { value: \"brown\", name: \"棕色\" },\n  { value: \"blue\", name: \"蓝色\" },\n  { value: \"pink\", name: \"粉红\" },\n];\n\nconst rawV2Colors = [\n  { value: \"black\", name: \"黑色\" },\n  { value: \"silver\", name: \"银灰\" },\n  { value: \"#634200\", name: \"深褐\" },\n  { value: \"#e39700\", name: \"暗橙\" },\n  { value: \"#d4e300\", name: \"金色\" },\n  { value: \"#1ee300\", name: \"草绿\" },\n  { value: \"#26067d\", name: \"靛色\" },\n  { value: \"#c20cf0\", name: \"蓝紫\" },\n  { value: \"#fc6d0d\", name: \"阳橙\" },\n  { value: \"#0dfccc\", name: \"蓝绿\" },\n  { value: \"#095157\", name: \"暗岩灰\" },\n  { value: \"#8a0e1e\", name: \"暗红\" },\n  { value: \"#e31717\", name: \"鲜红\" },\n  { value: \"#1717e3\", name: \"蓝色\" },\n  { value: \"#fc1956\", name: \"樱桃红\" },\n  { value: \"#bd1c72\", name: \"品红\" },\n  { value: \"#b06635\", name: \"锗黄\" },\n  { value: \"#315723\", name: \"暗绿\" },\n  { value: \"#bda855\", name: \"暗卡其\" },\n  { value: \"#9a55bd\", name: \"中蓝紫\" },\n  { value: \"#5ebd5e\", name: \"叶绿\" },\n  { value: \"#65a8c9\", name: \"灰蓝\" },\n  { value: \"#6b88d6\", name: \"矢车菊蓝\" },\n  { value: \"#68bdac\", name: \"中碧蓝\" },\n  { value: \"#575034\", name: \"咖啡\" },\n  { value: \"#d68c81\", name: \"玫瑰褐\" },\n  { value: \"#3d4057\", name: \"普鲁士蓝\" },\n  { value: \"#bd84a2\", name: \"火鹤红\" },\n  { value: \"#574141\", name: \"暗灰\" },\n  { value: \"#ebf0d8\", name: \"米黄\" },\n  { value: \"#eae3fc\", name: \"薰衣草紫\" },\n];\n\nexport type ColorPalette = 'bbs' | 'v2';\n\nexport interface PaletteInfo {\n  id: ColorPalette;\n  name: string;\n  description: string;\n  contents: () => Record<string, DescribedColor>,\n}\n\nexport const colorPalettes: Record<ColorPalette, PaletteInfo> = {\n  'v2': {\n    id: 'v2',\n    name: '色板v2（推荐）',\n    description: '“色板v2”包括31个精心挑选的颜色，增强了色彩间的对比度以及与白色背景的对比度，缺点是无法输出至BBS代码。',\n    contents: once(() => initializeColors(rawV2Colors)),\n  },\n  'bbs': {\n    id: 'bbs',\n    name: 'BBS颜色',\n    description: '“BBS色板”包含18个常见于BBS的颜色，是传统的配色方案，缺点是色彩间的区分度及与背景的对比度无法保证。',\n    contents: once(() => initializeColors(rawBbsColors)),\n  },\n}\n"],"sourceRoot":""}